<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administra√ß√£o - CMG Postos</title>
    <link rel="stylesheet" href="css/admin.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="admin-header">
        <div class="header-content">
            <div class="header-left">
                <a href="index.html" class="btn-voltar">‚Üê Voltar</a>
                <h1>‚öôÔ∏è Administra√ß√£o</h1>
            </div>
            <div class="header-right">
                <span class="admin-badge">Painel Administrativo</span>
            </div>
        </div>
    </header>

    <main class="admin-main">
        <div class="container">
            
            <!-- Se√ß√£o: Importar Estabelecimentos -->
            <section class="admin-section">
                <div class="section-header">
                    <h2>üè™ Planilha de Estabelecimentos</h2>
                    <span class="section-badge">XLSX</span>
                </div>
                <p class="section-description">
                    Importe a planilha com os dados cadastrais dos postos credenciados (nome, endere√ßo, CNPJ, terminal).
                </p>
                
                <div class="upload-area" id="uploadEstabelecimentos">
                    <div class="upload-icon">üìÑ</div>
                    <p>Arraste o arquivo XLSX aqui ou clique para selecionar</p>
                    <input type="file" id="fileEstabelecimentos" accept=".xlsx,.xls" onchange="processarEstabelecimentos(this)">
                </div>
                
                <div id="statusEstabelecimentos" class="status-message"></div>
                <div id="progressEstabelecimentos" class="progress-container" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFillEstab"></div>
                    </div>
                    <span class="progress-text" id="progressTextEstab">0%</span>
                </div>
            </section>

            <!-- Se√ß√£o: Importar Pre√ßos dos Postos -->
            <section class="admin-section">
                <div class="section-header">
                    <h2>‚õΩ Pre√ßo dos Postos (ANP)</h2>
                    <span class="section-badge">XLSX</span>
                </div>
                <p class="section-description">
                    Importe as planilhas de pre√ßos da plataforma ANP. S√£o 2 arquivos: um para Gasolina e outro para Etanol.
                </p>
                
                <div class="upload-grid">
                    <!-- Gasolina -->
                    <div class="upload-item">
                        <div class="upload-item-header">
                            <span class="upload-icon-small">üî¥</span>
                            <strong>Gasolina</strong>
                        </div>
                        <div class="upload-area-small" id="uploadGasolina">
                            <p>Clique ou arraste o arquivo</p>
                            <input type="file" id="fileGasolina" accept=".xlsx,.xls" onchange="processarPrecoPostos(this, 'gasolina')">
                        </div>
                        <div id="statusGasolina" class="status-message"></div>
                    </div>
                    
                    <!-- Etanol -->
                    <div class="upload-item">
                        <div class="upload-item-header">
                            <span class="upload-icon-small">üü¢</span>
                            <strong>Etanol / √Ålcool</strong>
                        </div>
                        <div class="upload-area-small" id="uploadEtanol">
                            <p>Clique ou arraste o arquivo</p>
                            <input type="file" id="fileEtanol" accept=".xlsx,.xls" onchange="processarPrecoPostos(this, 'etanol')">
                        </div>
                        <div id="statusEtanol" class="status-message"></div>
                    </div>
                </div>
                
                <div id="resumoPrecos" class="resumo-importacao"></div>
            </section>

            <!-- Se√ß√£o: Dados Atuais -->
            <section class="admin-section">
                <div class="section-header">
                    <h2>üìä Dados Atuais</h2>
                    <button class="btn-secondary" onclick="atualizarEstatisticas()">üîÑ Atualizar</button>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üè™</div>
                        <div class="stat-info">
                            <span id="statTotalPostos" class="stat-valor">0</span>
                            <span class="stat-label">Postos Cadastrados</span>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üî¥</div>
                        <div class="stat-info">
                            <span id="statPostosGasolina" class="stat-valor">0</span>
                            <span class="stat-label">Com Pre√ßo Gasolina</span>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üü¢</div>
                        <div class="stat-info">
                            <span id="statPostosEtanol" class="stat-valor">0</span>
                            <span class="stat-label">Com Pre√ßo Etanol</span>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üìç</div>
                        <div class="stat-info">
                            <span id="statPostosGeo" class="stat-valor">0</span>
                            <span class="stat-label">Com Geolocaliza√ß√£o</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Se√ß√£o: Gerenciar Dados -->
            <section class="admin-section">
                <div class="section-header">
                    <h2>üóÇÔ∏è Gerenciar Dados</h2>
                </div>
                
                <div class="actions-grid">
                    <button class="btn-action" onclick="exportarDados()">
                        <span class="btn-icon">üì•</span>
                        <span class="btn-text">Exportar Dados</span>
                        <span class="btn-desc">Baixar backup em JSON</span>
                    </button>
                    
                    <button class="btn-action" onclick="document.getElementById('fileImportBackup').click()">
                        <span class="btn-icon">üì§</span>
                        <span class="btn-text">Importar Backup</span>
                        <span class="btn-desc">Restaurar dados de backup</span>
                        <input type="file" id="fileImportBackup" accept=".json" style="display:none" onchange="importarBackup(this)">
                    </button>
                    
                    <button class="btn-action warning" onclick="confirmarLimpeza()">
                        <span class="btn-icon">üóëÔ∏è</span>
                        <span class="btn-text">Limpar Dados</span>
                        <span class="btn-desc">Remover todos os dados</span>
                    </button>
                    
                    <button class="btn-action" onclick="geocodificarTodos()">
                        <span class="btn-icon">üåç</span>
                        <span class="btn-text">Geocodificar</span>
                        <span class="btn-desc">Obter coordenadas GPS</span>
                    </button>
                </div>
            </section>

            <!-- Se√ß√£o: Lista de Postos -->
            <section class="admin-section">
                <div class="section-header">
                    <h2>üìã Postos Cadastrados</h2>
                    <div class="section-actions">
                        <input type="text" id="buscaPosto" placeholder="Buscar posto..." class="input-busca">
                    </div>
                </div>
                
                <div id="tabelaPostos" class="tabela-container">
                    <table class="tabela-postos">
                        <thead>
                            <tr>
                                <th>Terminal</th>
                                <th>Nome</th>
                                <th>Endere√ßo</th>
                                <th>Gasolina</th>
                                <th>Etanol</th>
                                <th>GPS</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyPostos">
                            <!-- Linhas inseridas via JavaScript -->
                        </tbody>
                    </table>
                </div>
            </section>

        </div>
    </main>

    <!-- Modal de Confirma√ß√£o -->
    <div id="modalConfirm" class="modal">
        <div class="modal-content modal-small">
            <h3 id="modalConfirmTitle">Confirmar</h3>
            <p id="modalConfirmText">Tem certeza?</p>
            <div class="modal-actions">
                <button class="btn-secondary" onclick="fecharModalConfirm()">Cancelar</button>
                <button class="btn-danger" id="btnConfirmAction">Confirmar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Edi√ß√£o -->
    <div id="modalEditar" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="fecharModalEditar()">√ó</button>
            <h3>‚úèÔ∏è Editar Posto</h3>
            <form id="formEditarPosto">
                <input type="hidden" id="editId">
                
                <div class="form-group">
                    <label for="editNome">Nome Fantasia:</label>
                    <input type="text" id="editNome" required>
                </div>
                
                <div class="form-group">
                    <label for="editEndereco">Endere√ßo:</label>
                    <input type="text" id="editEndereco">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="editLat">Latitude:</label>
                        <input type="number" id="editLat" step="any">
                    </div>
                    <div class="form-group">
                        <label for="editLng">Longitude:</label>
                        <input type="number" id="editLng" step="any">
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="fecharModalEditar()">Cancelar</button>
                    <button type="submit" class="btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/admin.js"></script>
</body>
</html>
